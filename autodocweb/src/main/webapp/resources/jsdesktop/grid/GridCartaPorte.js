Ext		.define(				'MyDesktop.grid.GridCartaPorte',				{					extend : 'Ext.grid.Panel',					requires : [ 'Ext.grid.column.Action',							'Ext.grid.plugin.CellEditing',							'Ext.form.field.Text', 'Ext.toolbar.TextItem',							'Ext.menu.Menu' ],					stateful : true,					collapsible : false,					multiSelect : true,					stateId : 'stateGridConsultaEtiquetas',					viewConfig : {						stripeRows : true,						enableTextSelection : true					},					uuid : undefined,					idregistro : undefined,					id : undefined,					isConsulta : false,					myScope : undefined,					uuid : undefined,					idregistro : undefined,					mystore : undefined,					isCancelar : true,					icita : true,					irechazo : true,					encabezados : '',					ismenuDesabled : false,					customStore : undefined,					ocultaBotonPDF : false,					ocultaBotonExportar : false,					isFueraSitio : false,					initComponent : function() {						var ismenuDesabled = false;						var today = new Date();						if (this.customStore == undefined) {							this.store = Ext									.create(											'MyDesktop.store.StoreCartaPorte',											{});						} else {							this.store = this.customStore;						}						this.myScope = this;						var my_scope = this;						this.listeners = {							beforeitemcontextmenu : function(view, record,									item, index, e) {								e.stopEvent();								gridMenu.showAt(e.getXY());							}						};						this.tbar = [ {							xtype : 'label',							text : 'Numero de viaje:'						}, {							xtype : 'textfield',							id : 'idviaje' + my_scope.id,							allowBlank : true,							width : 250						}, {							tooltip : 'Realiza la busqueda (CTRL+B)',							iconCls : 'search_blue',							handler : my_scope.realizaConsulta,							scope : this						}						];						var globalKeyMap = new Ext.KeyMap(document);						globalKeyMap.accessKey = function(key, handler, scope) {							var h = function(n, e) {								e.preventDefault();								handler.call(scope || this, n, e);							};							this.on(key, h, scope);						};						this.selType = 'checkboxmodel';						this.columns = [						{							header : 'ID Control',							tooltip : 'Identificador de Control',							width : 170,							sortable : true,							hidden : true,							dataIndex : 'idControl',							menuDisabled : my_scope.ismenuDesabled						},						{							header : 'Numero de Viaje',							tooltip : 'Viaje',							width : 170,							sortable : true,							hidden : false,							dataIndex : 'idViaje',							menuDisabled : my_scope.ismenuDesabled						},						{							header : 'F.Creacion',							tooltip : 'Fecha de creacion',							width : 170,							sortable : true,							hidden : false,							dataIndex : 'fecha',							menuDisabled : my_scope.ismenuDesabled						}, {							header : 'Factura',							tooltip : 'Numero de Factura',							width : 210,							sortable : true,							hidden : false,							dataIndex : 'factura',							menuDisabled : my_scope.ismenuDesabled						},						{							header : 'Referencia',							tooltip : 'Folio o numero de referencia',							width : 150,							sortable : true,							hidden : false,							dataIndex : 'referencia',							menuDisabled : my_scope.ismenuDesabled,							renderer : my_scope.formatoCeldaTexto						},						{							header : 'Estatus',							tooltip : 'Estado de la Factura',							width : 80,							sortable : true,							hidden : false,							dataIndex : 'estatus',							menuDisabled : my_scope.ismenuDesabled,							renderer : my_scope.formatoCeldaTexto						},						{							header : 'Mensaje',							tooltip : 'Mensaje de apoyo',							width : 300,							sortable : true,							hidden : false,							dataIndex : 'mensaje',							menuDisabled : my_scope.ismenuDesabled,							renderer : my_scope.formatoCeldaTexto						}						];						this.dockedItems = [ {							xtype : 'toolbar',							dock : 'bottom',							items : [							         /*									{										text : "Exportar",										tooltip : 'Exporta la info de la guia a Excel',										scope : my_scope,										iconCls : 'excel_blue',										id : 'idexportarMenuDes',										handler : my_scope.exportarExcel,										hidden : my_scope.ocultaBotonExportar									},									*/									'->',									{										text : 'Generar Carta Porte',										iconCls : 'pdf_blue',										handler : my_scope.reenviaOrdenesPedido,										scope : my_scope,										tooltip : 'Enviar a facturar',										handler : function() {											var forma_attachment = Ext													.create('MyDesktop.form.FormCrearCCP');											var winimport = Ext													.create(															'widget.window',															{																// id:'utils-win-agregar-cliente-attachment',																title : "Crear Carta Porte",																width : 450,																iconCls : 'editar',																height : 200,																modal : true,																plain : true,																layout : 'fit',																items : forma_attachment															});											winimport.show();										}									} ]						} ];						this.bbar = [ Ext								.create(										'Ext.PagingToolbar',										{											store : this.store,											displayInfo : true,											displayMsg : 'Desplegando {0} - {1} of {2}',											emptyMsg : "<font color=red><b>No se encontro informacion que desplegar</b></font>"										}) ];						if (!my_scope.isConsulta) {							this.on('render', function() {								globalKeyMap.accessKey({									key : 'b',									ctrl : true,									alt : false								}, my_scope.realizaConsulta, my_scope);								globalKeyMap.accessKey({									key : 'p',									ctrl : true,									alt : false								}, my_scope.abreVentanaPDF, my_scope);								globalKeyMap.accessKey({									key : 'h',									ctrl : true,									alt : false								}, my_scope.abreVentanaHistoria, my_scope);								globalKeyMap.accessKey({									key : 'n',									ctrl : true,									alt : false								}, my_scope.abreVentanaNotas, my_scope);								globalKeyMap.accessKey({									key : 'e',									ctrl : true,									alt : false								}, my_scope.exportarExcel, my_scope);								globalKeyMap.accessKey({									key : 'o',									ctrl : true,									alt : false								}, my_scope.cancelarRecord, my_scope);							});						}						this.callParent();					},					buscar : function(myscope) {						if (!isValidValueCampo('idviaje' + myscope.id,								'Indique el dato que desea buscar')) {							return;						}						myscope.getView().getStore().load(								{									params : {										viaje : Ext.getCmp(												'idviaje' + myscope.id)												.getValue()									},									callback : function(r, options, success) {										/*										 * if (r.length<=0){ Ext.Msg.show({										 * title: 'Aviso', msg: 'No existe										 * informaciï¿½n con el criterio de										 * busqueda selecionado.', modal: false,										 * icon: Ext.Msg.INFO, buttons:										 * Ext.Msg.OK }); }										 */									}								});											},					realizaConsulta : function() {						this.store.removeAll();						this.buscar(this);					}				});